# Notion标题自动序号浏览器插件

## 项目概述

这个浏览器插件旨在为Notion页面中的标题自动添加序号，以提高文档的结构清晰度和可读性。用户可以通过简单的开关控制是否启用自动序号功能，也可以手动应用或移除序号。

## 功能需求

### 核心功能
1. **自动标题序号**: 为Notion页面中的所有标题（H1, H2, H3等）自动添加层级序号
2. **开关控制**: 用户可以随时开启或关闭自动序号功能
3. **手动操作**: 提供手动添加和移除序号的按钮
4. **智能识别**: 能够识别Notion中的标题层级，并按照层级关系生成序号（如1, 1.1, 1.1.1）
5. **实时更新**: 当页面内容变化时（如添加新标题、调整标题层级），自动更新序号

### 用户界面
1. 简洁的弹出窗口，包含开关和操作按钮
2. 状态指示，显示当前是否启用了自动序号功能
3. 清晰的操作提示和反馈

## 技术方案

### 插件结构
```
notion-auto-numbering/
├── manifest.json         # 插件配置文件
├── popup.html            # 弹出窗口HTML
├── popup.js              # 弹出窗口交互逻辑
├── content.js            # 注入到Notion页面的脚本
├── background.js         # 后台脚本
└── images/               # 图标和资源
    ├── icon16.png
    ├── icon48.png
    └── icon128.png
```

### 技术实现细节

#### 1. Notion页面结构分析
- Notion使用特定的HTML结构来表示不同级别的标题
- 需要识别这些结构并找到合适的注入点来添加序号
- 通过DOM选择器定位标题元素，例如：
  ```javascript
  // 这只是示例，实际选择器需要根据Notion的DOM结构确定
  const headings = document.querySelectorAll('.notion-header-block');
  ```

#### 2. 序号生成算法
- 根据标题的层级关系生成序号
- 例如：
  - H1: 1, 2, 3, ...
  - H2 (在第1个H1下): 1.1, 1.2, 1.3, ...
  - H3 (在第1.2个H2下): 1.2.1, 1.2.2, ...
- 需要维护一个计数器数组，记录每一级标题的当前计数

#### 3. DOM操作实现
- 为标题元素添加序号前缀
- 可以通过以下方式实现：
  1. 创建新的文本节点包含序号
  2. 将序号节点插入到标题文本之前
  3. 标记添加的序号，以便后续可以识别和移除

#### 4. 动态内容处理
- 使用MutationObserver监听DOM变化
- 当检测到新标题元素或标题层级变化时，重新计算并应用序号
- 实现防抖处理，避免频繁更新导致的性能问题

#### 5. 状态管理
- 使用Chrome Storage API保存用户设置
- 在页面加载和设置变更时同步状态

## 开发计划

### 第一阶段: 基础框架搭建
1. 创建插件基本结构和配置文件
2. 实现弹出窗口UI和基础交互
3. 建立与Notion页面的连接机制

### 第二阶段: 核心功能实现
1. 分析Notion页面DOM结构，确定标题元素的定位方式
2. 实现标题层级识别算法
3. 开发序号生成和应用逻辑
4. 添加动态内容监听和处理机制

### 第三阶段: 完善和优化
1. 改进用户界面，增强用户体验
2. 处理各种边缘情况，如特殊格式的标题
3. 优化性能，减少资源占用
4. 增加错误处理和日志记录

### 第四阶段: 测试和发布
1. 在不同Notion页面上测试功能
2. 修复发现的问题
3. 准备插件发布材料
4. 发布到Chrome Web Store

## 安装和使用指南

### 安装方法
1. 下载项目代码
2. 打开Chrome浏览器，进入扩展管理页面（chrome://extensions/）
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"，选择项目文件夹

### 使用方法
1. 进入任意Notion页面
2. 点击浏览器工具栏中的插件图标
3. 在弹出窗口中开启"自动序号"功能
4. 自动为页面中的标题添加序号
5. 也可以点击"立即应用序号"手动触发序号添加
6. 如需移除序号，点击"移除所有序号"按钮

## 注意事项和限制
1. 插件仅在Notion网页版（notion.so域名下）工作
2. 可能与其他修改Notion页面的插件产生冲突
3. Notion界面更新可能导致插件需要相应更新

## 贡献指南
欢迎对本项目提出改进建议或贡献代码。请通过以下步骤参与：
1. Fork本仓库
2. 创建功能分支 (`git checkout -b feature/your-feature`)
3. 提交更改 (`git commit -m 'Add some feature'`)
4. 推送到分支 (`git push origin feature/your-feature`)
5. 创建Pull Request

## 许可证
[MIT License](LICENSE) 